<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
		<script type="text/javascript" src="http://172.27.92.10/javascripts/api/tableau-2.min.js">
                </script>
                <script type="text/javascript">
                    var workbook, activeSheet;
                    var tabs =["Metrics Dashboard","NPS Dashboard","Metric Selected Dashboard"];
                    var viz;

                    function initViz() {
                        console.log("test");
                        var width = window.screen.width;
                        var height = window.screen.height;

                        var containerDiv = document.getElementById("vizContainer"),
                            url = "http://172.27.92.10/t/OperationalDashboards/views/TVDashboard-Product/MetricSelectedDashboard";

                        var options = {

                            width: width,
                            height: height,
                            marginLeft: "0px",
                            marginRight: "0px",
                            paddingLeft: "0px",
                            paddingRight: "0px",
                            hideTabs: false,
                            hideToolbar: false,
                            onFirstInteractive: function () {
                            workbook = viz.getWorkbook();
                            activeSheet = workbook.getActiveSheet();
                        }
                    };

                        viz = new tableau.Viz(containerDiv, url, options);

                        changeTabs();
                    }

                    function sleep(milliseconds) {
                        var start = new Date().getTime();
                        for (var i = 0; i < 1e8; i++) {
                            if ((new Date().getTime() - start) > milliseconds){
                                break;
                            }
                        }
                    }

                    function switchToMapTab(i) {
                        if(i <= tabs.length-1 && i >= 0) {
                            console.log("start");
                            console.log(tabs[i]);
                            workbook.activateSheetAsync(tabs[i]);
                            console.log("wait");
                            sleep(10000);
                            console.log("done");
                        }
                    }

                    function changeTabs() {
                        var i = 0;
                        var y = 1;
                        switchToMapTab(i);
                        viz.show();
                        switchToMapTab(y);
                    }
                </script>
	</head>
	<body onload="initViz();">
		<div class="reveal">
			<div class="slides">
				<section>
				<div id="vizContainer"></div>
				</section>
				<section>Slide 2</section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script>
	</body>
</html>
